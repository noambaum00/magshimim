!function(_){"use strict";function __parseURL(href){var match=href.match(/^(https?\:)\/\/(([^:\/?#]*)(?:\:([0-9]+))?)(\/[^?#]*)(\?[^#]*|)(#.*|)$/);return match&&{protocol:match[1],host:match[2],hostname:match[3],port:match[4]||80,pathname:match[5],action:""===match[5].substring(1)?match[2].indexOf("homepage")>-1||"www.walla.co.il"===match[2]||"test.walla.co.il"===match[2]?"hp":"main":match[5].substring(1).split("/")[0],search:match[6],query:"undefined"!=typeof match[6]&&null!==match[6]?__parseQueryString(match[6].substring(1)):{},hash:match[7]}}function __parseQueryString(query){var queryObject={};if(!query)return queryObject;for(var queryArray=query.split("&"),index=0;index<queryArray.length;index+=1){var currentPair=queryArray[index].split("=");currentPair&&2===currentPair.length&&(queryObject[decodeURIComponent(currentPair[0])]=decodeURIComponent(currentPair[1]))}return queryObject}function __getCookie(name){var start=document.cookie.indexOf(name+"="),len=start+name.length+1;if(!start&&name!==document.cookie.substring(0,name.length))return null;if(start===-1)return null;var end=document.cookie.indexOf(";",len);return end===-1&&(end=document.cookie.length),_.decodeURI(document.cookie.substring(len,end))}function __setCookie(name,value,expires,path,domain,secure){var today=new Date,_currentLoacation=__parseURL(window.location.href),_path=path||_currentLoacation.pathname,_domain=domain||_currentLoacation.domain,_expires=expires||0;today.setTime(today.getTime());var expires_date=new Date(today.getTime()+_expires);document.cookie=name+"="+_.decodeURI(value)+(expires?";expires="+expires_date.toUTCString():"")+(_path?";path="+_path:"")+(_domain?";domain="+_domain:"")+(secure?";secure":"")}function __extendArray(destination,source){for(var property in source)source.hasOwnProperty(property)&&source[property].constructor&&source[property].constructor===Object?(destination[property]=destination[property]||{},__extendArray(destination[property],source[property])):destination[property]=source[property];return destination}_.dfpTargeting=function(_config){var currentLocation=__parseURL(_.location.href),defaultConfig={},isHp="hp"===currentLocation.action;defaultConfig.age=__getCookie("age")||"0",defaultConfig.app_version=__getCookie("app_version")||"0",defaultConfig.app_name=__getCookie("app_name")||"",defaultConfig.gender="1"===__getCookie("gender")?"M":"2"===__getCookie("gender")?"F":"O",defaultConfig.auto_refresh=__getCookie("ZZZrf_ck")||"",defaultConfig.ssl="https:"===currentLocation.protocol?"yes":"no",defaultConfig.stitial=__getCookie("stitial")||"",defaultConfig.page_type=currentLocation.action,defaultConfig.location=currentLocation,defaultConfig.first_view=__getCookie("firstView")||"yes",defaultConfig.dmp=__getCookie("dmp")?decodeURIComponent(__getCookie("dmp")).split(","):[],defaultConfig.sponsorship=__getCookie("sponsorship")||"yes",defaultConfig.triggerEvent=function(eventName,options){var event;_.CustomEvent?event=new CustomEvent(eventName,options):(event=document.createEvent("CustomEvent"),event.initCustomEvent(eventName,!0,!0,options)),document.dispatchEvent(event)},defaultConfig.subscribeToEvent=function(eventName,callback){document.addEventListener?document.addEventListener(eventName,callback):document.attachEvent("on"+eventName,function(){callback.call(document)})};var cookieExpirationDate=new Date,age=parseInt(defaultConfig.age);switch(!0){case age>=0&&age<=5:defaultConfig.agegroup="0";break;case age>=6&&age<=12:defaultConfig.agegroup="1";break;case age>=13&&age<=17:defaultConfig.agegroup="2";break;case age>=18&&age<=25:defaultConfig.agegroup="3";break;case age>=26&&age<=35:defaultConfig.agegroup="4";break;case age>=36&&age<=45:defaultConfig.agegroup="5";break;case age>=46&&age<=59:defaultConfig.agegroup="6";break;case age>=60:defaultConfig.agegroup="7";break;default:defaultConfig.agegroup="99"}if(defaultConfig.location.query.mobile&&"1"===defaultConfig.location.query.mobile?defaultConfig.mobile="1":defaultConfig.mobile="0","not"===_config.exclusive){var maxStep=isHp?4:2,hpIsActive=__getCookie("hpActive")||"no",isPlayerFrame="wallaplayer"===currentLocation.action,canSetStrip=!isPlayerFrame||isHp||"no"===hpIsActive;isHp&&__setCookie("hpActive","yes",null,"/","walla.co.il"),defaultConfig.strip_step=__getCookie("strip_step")||"0","after_prime"!==defaultConfig.strip_step&&defaultConfig.strip_step<maxStep&&canSetStrip?defaultConfig.strip_step=parseInt(defaultConfig.strip_step)+1:canSetStrip&&(defaultConfig.strip_step="after_prime"),cookieExpirationDate.setDate(cookieExpirationDate.getDate()+1),cookieExpirationDate.setHours(0),cookieExpirationDate.setMinutes(0),cookieExpirationDate.setSeconds(0),__setCookie("strip_step",defaultConfig.strip_step,cookieExpirationDate.getTime()-Date.now(),"/",currentLocation.host)}if("yes"===defaultConfig.first_view){var fvDate=new Date,fvMinutes=5;fvDate.setTime(fvDate.getTime()+60*fvMinutes*1e3),__setCookie("firstView","no",fvDate.getTime()-Date.now(),"/","walla.co.il")}if("yes"===defaultConfig.sponsorship){var sponsorshipDate=new Date;sponsorshipDate.setMinutes(sponsorshipDate.getMinutes()+5),__setCookie("sponsorship","no",sponsorshipDate.getTime()-Date.now(),"/","walla.co.il")}return"1"===defaultConfig.stitial&&__setCookie("stitial","",Date.now()-1,"/","walla.co.il"),__extendArray(defaultConfig,_config)}}(window);